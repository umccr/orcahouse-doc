{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-03-23T22:53:00.212806Z", "invocation_id": "85ce1d67-c769-499f-94b2-879572c38878", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.063502Z", "completed_at": "2025-03-23T22:53:00.072343Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.072593Z", "completed_at": "2025-03-23T22:53:00.072603Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01753973960876465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.spreadsheet_google_lims", "compiled": true, "compiled_code": "\n\nwith cutoff as (\n\n    select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\nsource as (\n\n    select\n        *\n    from\n        \"orcavault\".\"tsa\".\"spreadsheet_google_lims\"\n\n    \n\n    where cast(\"timestamp\" as timestamptz) + time '11:00' > ( select ldts from cutoff )\n\n    \n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(illumina_id, E'[\\\\n\\\\r]+', '', 'g')) as illumina_id,\n        trim(regexp_replace(run, E'[\\\\n\\\\r]+', '', 'g')) as run,\n        trim(regexp_replace(\"timestamp\", E'[\\\\n\\\\r]+', '', 'g')) as \"timestamp\",\n        trim(regexp_replace(subject_id, E'[\\\\n\\\\r]+', '', 'g')) as subject_id,\n        trim(regexp_replace(sample_id, E'[\\\\n\\\\r]+', '', 'g')) as sample_id,\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        trim(regexp_replace(external_subject_id, E'[\\\\n\\\\r]+', '', 'g')) as external_subject_id,\n        trim(regexp_replace(external_sample_id, E'[\\\\n\\\\r]+', '', 'g')) as external_sample_id,\n        trim(regexp_replace(external_library_id, E'[\\\\n\\\\r]+', '', 'g')) as external_library_id,\n        trim(regexp_replace(sample_name, E'[\\\\n\\\\r]+', '', 'g')) as sample_name,\n        trim(regexp_replace(project_owner, E'[\\\\n\\\\r]+', '', 'g')) as project_owner,\n        trim(regexp_replace(project_name, E'[\\\\n\\\\r]+', '', 'g')) as project_name,\n        trim(regexp_replace(project_custodian, E'[\\\\n\\\\r]+', '', 'g')) as project_custodian,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(override_cycles, E'[\\\\n\\\\r]+', '', 'g')) as override_cycles,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality,\n        trim(regexp_replace(topup, E'[\\\\n\\\\r]+', '', 'g')) as topup,\n        trim(regexp_replace(secondary_analysis, E'[\\\\n\\\\r]+', '', 'g')) as secondary_analysis,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(tags, E'[\\\\n\\\\r]+', '', 'g')) as tags,\n        trim(regexp_replace(fastq, E'[\\\\n\\\\r]+', '', 'g')) as fastq,\n        trim(regexp_replace(number_fastqs, E'[\\\\n\\\\r]+', '', 'g')) as number_fastqs,\n        trim(regexp_replace(results, E'[\\\\n\\\\r]+', '', 'g')) as results,\n        trim(regexp_replace(trello, E'[\\\\n\\\\r]+', '', 'g')) as trello,\n        trim(regexp_replace(notes, E'[\\\\n\\\\r]+', '', 'g')) as notes,\n        trim(regexp_replace(todo, E'[\\\\n\\\\r]+', '', 'g')) as todo,\n        trim(regexp_replace(sheet_name, E'[\\\\n\\\\r]+', '', 'g')) as sheet_name\n    from\n        source\n    where\n        coalesce\n        (\n            nullif(illumina_id, ''),\n            nullif(run, ''),\n            nullif(\"timestamp\", ''),\n            nullif(subject_id, ''),\n            nullif(sample_id, ''),\n            nullif(library_id, ''),\n            nullif(external_subject_id, ''),\n            nullif(external_sample_id, ''),\n            nullif(external_library_id, ''),\n            nullif(sample_name, ''),\n            nullif(project_owner, ''),\n            nullif(project_name, ''),\n            nullif(project_custodian, ''),\n            nullif(type, ''),\n            nullif(assay, ''),\n            nullif(override_cycles, ''),\n            nullif(phenotype, ''),\n            nullif(source, ''),\n            nullif(quality, ''),\n            nullif(topup, ''),\n            nullif(secondary_analysis, ''),\n            nullif(workflow, ''),\n            nullif(tags, ''),\n            nullif(fastq, ''),\n            nullif(number_fastqs, ''),\n            nullif(results, ''),\n            nullif(trello, ''),\n            nullif(notes, ''),\n            nullif(todo, ''),\n            nullif(sheet_name, '')\n        ) is not null\n\n),\n\ntransformed as (\n\n    select\n        illumina_id,\n        cast(run as integer),\n        cast(\"timestamp\" as date) as \"timestamp\",\n        subject_id,\n        sample_id,\n        library_id,\n        external_subject_id,\n        external_sample_id,\n        external_library_id,\n        sample_name,\n        project_owner,\n        project_name,\n        project_custodian,\n        type,\n        assay,\n        override_cycles,\n        phenotype,\n        source,\n        quality,\n        topup,\n        secondary_analysis,\n        workflow,\n        tags,\n        fastq,\n        number_fastqs,\n        results,\n        trello,\n        notes,\n        todo,\n        sheet_name,\n        cast(\"timestamp\" as timestamptz) + time '11:00' as load_datetime,\n        (select 'Google_LIMS') as record_source\n    from\n        cleaned\n\n),\n\nfinal as (\n\n    select * from transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"psa\".\"spreadsheet_google_lims\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.057190Z", "completed_at": "2025-03-23T22:53:00.072979Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.073505Z", "completed_at": "2025-03-23T22:53:00.073510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01871180534362793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_s3object", "compiled": true, "compiled_code": "\n\nwith source1 as (\n\n    select\n        bucket,\n        \"key\"\n    from\n        \"orcavault\".\"ods\".\"data_portal_s3object\"\n    \n    where\n        cast(last_modified_date as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"hub_s3object\" )\n    \n\n),\n\nsource2 as (\n\n    select\n        bucket,\n        \"key\"\n    from\n        \"orcavault\".\"ods\".\"file_manager_s3_object\"\n    \n    where\n        cast(event_time as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"hub_s3object\" )\n    \n\n),\n\ncombined as (\n\n    select bucket, \"key\" from source1\n    union\n    select bucket, \"key\" from source2\n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(concat(bucket, \"key\")::bytea), 'hex') as s3object_hk,\n        bucket,\n        \"key\",\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 's3') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        combined\n\n),\n\nfinal as (\n\n    select\n        cast(s3object_hk as char(64)) as s3object_hk,\n        cast(bucket as varchar(255)) as bucket,\n        cast(\"key\" as text) as \"key\",\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_s3object\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.068516Z", "completed_at": "2025-03-23T22:53:00.073195Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.074004Z", "completed_at": "2025-03-23T22:53:00.074007Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017982006072998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_workflow_run", "compiled": true, "compiled_code": "\n\nwith source1 as (\n\n    select\n        portal_run_id\n    from\n        \"orcavault\".\"ods\".\"data_portal_workflow\"\n    \n    where\n        cast(start as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"hub_workflow_run\" )\n    \n\n),\n\nsource2 as (\n\n    select\n        portal_run_id\n    from \"orcavault\".\"ods\".\"workflow_manager_workflowrun\" wfr\n        join \"orcavault\".\"ods\".\"workflow_manager_state\" stt on stt.workflow_run_id = wfr.orcabus_id\n    \n    where\n        cast(stt.timestamp as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"hub_workflow_run\" )\n    \n\n),\n\ncombined as (\n\n    select distinct portal_run_id from source1\n    union\n    select distinct portal_run_id from source2\n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(portal_run_id as bytea)), 'hex') as workflow_run_hk,\n        portal_run_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'portal_workflow_manager') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        combined\n    order by portal_run_id\n\n),\n\nfinal as (\n\n    select\n        cast(workflow_run_hk as char(64)) as workflow_run_hk,\n        cast(portal_run_id as char(16)) as portal_run_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_workflow_run\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.066766Z", "completed_at": "2025-03-23T22:53:00.073797Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.074622Z", "completed_at": "2025-03-23T22:53:00.074624Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.018825054168701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.spreadsheet_library_tracking_metadata", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select * from \"orcavault\".\"tsa\".\"spreadsheet_library_tracking_metadata\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(comments, E'[\\\\n\\\\r]+', '', 'g')) as comments,\n        trim(regexp_replace(coverage, E'[\\\\n\\\\r]+', '', 'g')) as coverage,\n        trim(regexp_replace(experiment_id, E'[\\\\n\\\\r]+', '', 'g')) as experiment_id,\n        trim(regexp_replace(external_sample_id, E'[\\\\n\\\\r]+', '', 'g')) as external_sample_id,\n        trim(regexp_replace(external_subject_id, E'[\\\\n\\\\r]+', '', 'g')) as external_subject_id,\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        trim(regexp_replace(override_cycles, E'[\\\\n\\\\r]+', '', 'g')) as override_cycles,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(project_name, E'[\\\\n\\\\r]+', '', 'g')) as project_name,\n        trim(regexp_replace(project_owner, E'[\\\\n\\\\r]+', '', 'g')) as project_owner,\n        trim(regexp_replace(qpcr_id, E'[\\\\n\\\\r]+', '', 'g')) as qpcr_id,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality,\n        trim(regexp_replace(run, E'[\\\\n\\\\r]+', '', 'g')) as run,\n        trim(regexp_replace(sample_id, E'[\\\\n\\\\r]+', '', 'g')) as sample_id,\n        trim(regexp_replace(sample_name, E'[\\\\n\\\\r]+', '', 'g')) as sample_name,\n        trim(regexp_replace(samplesheet_sample_id, E'[\\\\n\\\\r]+', '', 'g')) as samplesheet_sample_id,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source,\n        trim(regexp_replace(subject_id, E'[\\\\n\\\\r]+', '', 'g')) as subject_id,\n        trim(regexp_replace(truseq_index, E'[\\\\n\\\\r]+', '', 'g')) as truseq_index,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(r_rna, E'[\\\\n\\\\r]+', '', 'g')) as r_rna,\n        trim(regexp_replace(study, E'[\\\\n\\\\r]+', '', 'g')) as study,\n        trim(regexp_replace(sheet_name, E'[\\\\n\\\\r]+', '', 'g')) as sheet_name\n    from\n        source\n    where\n        coalesce\n        (\n            nullif(assay, ''),\n            nullif(comments, ''),\n            nullif(coverage, ''),\n            nullif(experiment_id, ''),\n            nullif(external_sample_id, ''),\n            nullif(external_subject_id, ''),\n            nullif(library_id, ''),\n            nullif(override_cycles, ''),\n            nullif(phenotype, ''),\n            nullif(project_name, ''),\n            nullif(project_owner, ''),\n            nullif(qpcr_id, ''),\n            nullif(quality, ''),\n            nullif(run, ''),\n            nullif(sample_id, ''),\n            nullif(sample_name, ''),\n            nullif(samplesheet_sample_id, ''),\n            nullif(source, ''),\n            nullif(subject_id, ''),\n            nullif(truseq_index, ''),\n            nullif(type, ''),\n            nullif(workflow, ''),\n            nullif(r_rna, ''),\n            nullif(study, '')\n        ) is not null\n\n),\n\ndifferentiated as (\n\n    select\n        *\n    from\n        cleaned\n    \n    except\n    select\n        assay,\n        comments,\n        coverage,\n        experiment_id,\n        external_sample_id,\n        external_subject_id,\n        library_id,\n        override_cycles,\n        phenotype,\n        project_name,\n        project_owner,\n        qpcr_id,\n        quality,\n        run,\n        sample_id,\n        sample_name,\n        samplesheet_sample_id,\n        source,\n        subject_id,\n        truseq_index,\n        type,\n        workflow,\n        r_rna,\n        study,\n        sheet_name\n    from\n        \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    \n\n),\n\ntransformed as (\n\n    select\n        *,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'UMCCR_Library_Tracking_MetaData') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select * from transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.076774Z", "completed_at": "2025-03-23T22:53:00.088820Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.089093Z", "completed_at": "2025-03-23T22:53:00.089099Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01382899284362793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_sequencing_run", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select instrument_run_id as sequencing_run_id from \"orcavault\".\"ods\".\"data_portal_libraryrun\"\n    union\n    select instrument_run_id as sequencing_run_id from \"orcavault\".\"ods\".\"data_portal_sequence\"\n    union\n    select instrument_run_id as sequencing_run_id from \"orcavault\".\"ods\".\"data_portal_sequencerun\"\n    union\n    select instrument_run_id as sequencing_run_id from \"orcavault\".\"ods\".\"sequence_run_manager_sequence\"\n    union\n    select illumina_id as sequencing_run_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select illumina_id as sequencing_run_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where sequencing_run_id is not null and sequencing_run_id <> ''\n\n),\n\ndifferentiated as (\n\n    select sequencing_run_id from cleaned\n    \n    except\n    select sequencing_run_id from \"orcavault\".\"dcl\".\"hub_sequencing_run\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(sequencing_run_id as bytea)), 'hex') as sequencing_run_hk,\n        sequencing_run_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(sequencing_run_hk as char(64)) as sequencing_run_hk,\n        cast(sequencing_run_id as varchar(255)) as sequencing_run_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_sequencing_run\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.085847Z", "completed_at": "2025-03-23T22:53:00.090109Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.094878Z", "completed_at": "2025-03-23T22:53:00.094882Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0186460018157959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_s3object_portal", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        id,\n        bucket,\n        \"key\",\n        \"size\",\n        e_tag,\n        cast(last_modified_date as timestamptz) as last_modified_date\n    from\n        \"orcavault\".\"ods\".\"data_portal_s3object\"\n    \n    where\n        cast(last_modified_date as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_s3object_portal\" )\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(concat(bucket, \"key\")::bytea), 'hex') as s3object_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'data_portal_s3object') as record_source,\n        encode(sha256(concat(id, \"size\", e_tag, last_modified_date)::bytea), 'hex') as hash_diff,\n        id,\n        \"size\",\n        e_tag,\n        last_modified_date,\n        (select 0) as is_deleted\n    from\n        source\n\n),\n\nfinal as (\n\n    select\n        cast(s3object_hk as char(64)) as s3object_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(id as bigint) as id,\n        cast(\"size\" as bigint) as \"size\",\n        cast(e_tag as varchar(255)) as e_tag,\n        cast(last_modified_date as timestamptz) as last_modified_date,\n        cast(is_deleted as smallint) as is_deleted\n    from\n        transformed\n\n)\n\nselect * from final\n\nunion\n    select\n        cast(t.s3object_hk as char(64)) as s3object_hk,\n        cast(t.load_datetime as timestamptz) as load_datetime,\n        cast(t.record_source as varchar(255)) as record_source,\n        cast(t.hash_diff as char(64)) as hash_diff,\n        cast(t.id as bigint) as id,\n        cast(t.\"size\" as bigint) as \"size\",\n        cast(t.e_tag as varchar(255)) as e_tag,\n        cast(t.last_modified_date as timestamptz) as last_modified_date,\n        cast((select 1) as smallint) as is_deleted\n    from \"orcavault\".\"dcl\".\"sat_s3object_portal\" t\n        left join \"orcavault\".\"ods\".\"data_portal_s3object\" s on s.id = t.id\n    where\n        s.id is null and t.is_deleted = 0\n", "relation_name": "\"orcavault\".\"dcl\".\"sat_s3object_portal\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.080253Z", "completed_at": "2025-03-23T22:53:00.090303Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.095237Z", "completed_at": "2025-03-23T22:53:00.095239Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019523143768310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_s3object_computed_key", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        s3object_hk,\n        (regexp_match(\"key\", '(?:/)(\\d{8}[a-zA-Z0-9]{8})(?:/)'))[1] as portal_run_id,\n        (regexp_match(\"key\", '(?:/)(\\d{6}_A\\d{5}_\\d{4}_[A-Z0-9]{10})(?:/)'))[1] as sequencing_run_id,\n        (regexp_matches(\"key\", '(?:L\\d{7}|L(?:PRJ|CCR|MDX|TGX)\\d{6}|Undetermined)(?:(?:_topup\\d?)|(?:_rerun\\d?))?', 'g'))[1] as library_id,\n        regexp_replace(\"key\", '^.+[/\\\\]', '') as filename,\n        split_part(regexp_replace(\"key\", '^.+[/\\\\]', ''), '.', -1) as ext1,\n        split_part(regexp_replace(\"key\", '^.+[/\\\\]', ''), '.', -2) as ext2,\n        split_part(regexp_replace(\"key\", '^.+[/\\\\]', ''), '.', -3) as ext3,\n        load_datetime,\n        record_source\n    from\n        \"orcavault\".\"dcl\".\"hub_s3object\"\n    \n    where\n        cast(load_datetime as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_s3object_computed_key\" )\n    \n    group by s3object_hk, portal_run_id, sequencing_run_id, library_id\n\n),\n\ntransformed as (\n\n    select\n        s3object_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        record_source,\n        encode(sha256(concat(s3object_hk, portal_run_id, sequencing_run_id, library_id)::bytea), 'hex') as hash_diff,\n        portal_run_id,\n        sequencing_run_id,\n        library_id,\n        filename,\n        ext1,\n        ext2,\n        ext3\n    from\n        source\n\n),\n\nfinal as (\n\n    select\n        cast(s3object_hk as char(64)) as s3object_hk,\n        cast(hash_diff as char(64)) as s3object_sq,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(portal_run_id as char(16)) as portal_run_id,\n        cast(sequencing_run_id as varchar(255)) as sequencing_run_id,\n        cast(library_id as varchar(255)) as library_id,\n        cast(filename as text) as filename,\n        cast(ext1 as varchar(255)) as ext1,\n        cast(ext2 as varchar(255)) as ext2,\n        cast(ext3 as varchar(255)) as ext3\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_s3object_computed_key\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.083437Z", "completed_at": "2025-03-23T22:53:00.094690Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.095524Z", "completed_at": "2025-03-23T22:53:00.095527Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01960611343383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_s3object_history", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        *\n    from\n        \"orcavault\".\"ods\".\"file_manager_s3_object\"\n    \n    where\n        cast(event_time as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_s3object_history\" )\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(concat(bucket, \"key\")::bytea), 'hex') as s3object_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'file_manager_s3_object') as record_source,\n        encode(sha256(concat(\n            s3_object_id,\n            \"size\",\n            e_tag,\n            sha256,\n            last_modified_date,\n            event_time,\n            event_type,\n            version_id,\n            is_delete_marker,\n            sequencer,\n            storage_class,\n            attributes,\n            ingest_id,\n            reason,\n            archive_status\n        )::bytea), 'hex') as hash_diff,\n        *\n    from\n        source\n\n),\n\nfinal as (\n\n    select\n        cast(s3object_hk as char(64)) as s3object_hk,\n        cast(hash_diff as char(64)) as s3object_sq,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(s3_object_id as uuid) as s3_object_id,\n        cast(\"size\" as bigint) as \"size\",\n        cast(e_tag as varchar(255)) as e_tag,\n        cast(sha256 as text) as sha256,\n        cast(last_modified_date as timestamptz) as last_modified_date,\n        cast(event_time as timestamptz) as event_time,\n        cast(event_type as varchar(255)) as event_type,\n        cast(version_id as varchar(255)) as version_id,\n        cast(is_delete_marker as boolean) as is_delete_marker,\n        cast(sequencer as varchar(255)) as sequencer,\n        cast(storage_class as varchar(255)) as storage_class,\n        cast(attributes as jsonb) as attributes,\n        cast(ingest_id as uuid) as ingest_id,\n        cast(reason as varchar(255)) as reason,\n        cast(archive_status as varchar(255)) as archive_status\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_s3object_history\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.090499Z", "completed_at": "2025-03-23T22:53:00.096832Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.097501Z", "completed_at": "2025-03-23T22:53:00.097503Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007839202880859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_workflow_run_comment", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        wfr.portal_run_id as portal_run_id,\n        cmt.orcabus_id as orcabus_id,\n        cmt.comment as comment,\n        cmt.created_at as created_at,\n        cmt.created_by as created_by,\n        cmt.updated_at as updated_at,\n        cmt.is_deleted as is_deleted\n    from \"orcavault\".\"ods\".\"workflow_manager_workflowrun\" wfr\n        join \"orcavault\".\"ods\".\"workflow_manager_workflowruncomment\" cmt on cmt.workflow_run_id = wfr.orcabus_id\n    \n    where\n        cast(cmt.created_at as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_workflow_run_comment\" )\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(portal_run_id as bytea)), 'hex') as workflow_run_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'workflow_manager_workflowruncomment') as record_source,\n        encode(sha256(concat(\n            orcabus_id,\n            comment,\n            created_at,\n            created_by,\n            updated_at,\n            is_deleted\n        )::bytea), 'hex') as hash_diff,\n        orcabus_id,\n        comment,\n        created_at,\n        created_by,\n        updated_at,\n        is_deleted\n    from\n        source\n\n),\n\nfinal as (\n\n    select\n        cast(workflow_run_hk as char(64)) as workflow_run_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(orcabus_id as char(26)) as orcabus_id,\n        cast(comment as text) as comment,\n        cast(created_at as timestamptz) as created_at,\n        cast(created_by as varchar(255)) as created_by,\n        cast(updated_at as timestamptz) as updated_at,\n        cast(is_deleted as boolean) as is_deleted\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_workflow_run_comment\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.097905Z", "completed_at": "2025-03-23T22:53:00.104765Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.107760Z", "completed_at": "2025-03-23T22:53:00.107764Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011399269104003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_workflow_run_detail", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        wfr.portal_run_id as portal_run_id,\n        wfr.orcabus_id as workflow_run_orcabus_id,\n        wfr.execution_id as workflow_run_execution_id,\n        wfr.workflow_run_name as workflow_run_name,\n        wfr.comment as workflow_run_comment,\n        wfl.orcabus_id as workflow_orcabus_id,\n        wfl.workflow_name as workflow_name,\n        wfl.workflow_version as workflow_version,\n        wfl.execution_engine as workflow_execution_engine,\n        wfl.execution_engine_pipeline_id as workflow_execution_engine_pipeline_id,\n        stt.orcabus_id as state_orcabus_id,\n        stt.status as state_status,\n        stt.timestamp as state_timestamp,\n        stt.comment as state_comment,\n        pld.orcabus_id as payload_orcabus_id,\n        pld.payload_ref_id as payload_ref_id,\n        pld.version as payload_version,\n        pld.data as payload_data\n    from \"orcavault\".\"ods\".\"workflow_manager_workflowrun\" wfr\n        join \"orcavault\".\"ods\".\"workflow_manager_workflow\" wfl on wfl.orcabus_id = wfr.workflow_id\n        join \"orcavault\".\"ods\".\"workflow_manager_state\" stt on stt.workflow_run_id = wfr.orcabus_id\n        join \"orcavault\".\"ods\".\"workflow_manager_payload\" pld on pld.orcabus_id = stt.payload_id\n    \n    where\n        cast(stt.timestamp as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_workflow_run_detail\" )\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(portal_run_id as bytea)), 'hex') as workflow_run_hk,\n        encode(sha256(cast(state_orcabus_id as bytea)), 'hex') as workflow_run_sq,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'workflow_manager') as record_source,\n        encode(sha256(concat(\n            workflow_run_orcabus_id,\n            workflow_run_execution_id,\n            workflow_run_name,\n            workflow_run_comment,\n            workflow_orcabus_id,\n            workflow_name,\n            workflow_version,\n            workflow_execution_engine,\n            workflow_execution_engine_pipeline_id,\n            state_orcabus_id,\n            state_status,\n            state_timestamp,\n            state_comment,\n            payload_orcabus_id,\n            payload_ref_id,\n            payload_version\n        )::bytea), 'hex') as hash_diff,\n        workflow_run_orcabus_id,\n        workflow_run_execution_id,\n        workflow_run_name,\n        workflow_run_comment,\n        workflow_orcabus_id,\n        workflow_name,\n        workflow_version,\n        workflow_execution_engine,\n        workflow_execution_engine_pipeline_id,\n        state_orcabus_id,\n        state_status,\n        state_timestamp,\n        state_comment,\n        payload_orcabus_id,\n        payload_ref_id,\n        payload_version,\n        payload_data\n    from\n        source\n\n),\n\nfinal as (\n\n    select\n        cast(workflow_run_hk as char(64)) as workflow_run_hk,\n        cast(workflow_run_sq as char(64)) as workflow_run_sq,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(workflow_run_orcabus_id as char(26)) as workflow_run_orcabus_id,\n        cast(workflow_run_execution_id as varchar(255)) as workflow_run_execution_id,\n        cast(workflow_run_name as varchar(255)) as workflow_run_name,\n        cast(workflow_run_comment as varchar(255)) as workflow_run_comment,\n        cast(workflow_orcabus_id as char(26)) as workflow_orcabus_id,\n        cast(workflow_name as varchar(255)) as workflow_name,\n        cast(workflow_version as varchar(255)) as workflow_version,\n        cast(workflow_execution_engine as varchar(255)) as workflow_execution_engine,\n        cast(workflow_execution_engine_pipeline_id as varchar(255)) as workflow_execution_engine_pipeline_id,\n        cast(state_orcabus_id as varchar(26)) as state_orcabus_id,\n        cast(state_status as varchar(255)) as state_status,\n        cast(state_timestamp as timestamptz) as state_timestamp,\n        cast(state_comment as varchar(255)) as state_comment,\n        cast(payload_orcabus_id as char(26)) as payload_orcabus_id,\n        cast(payload_ref_id as varchar(255)) as payload_ref_id,\n        cast(payload_version as varchar(255)) as payload_version,\n        cast(payload_data as jsonb) as payload_data\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_workflow_run_detail\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.099973Z", "completed_at": "2025-03-23T22:53:00.104938Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.108065Z", "completed_at": "2025-03-23T22:53:00.108068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011491060256958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_workflow_run_portal", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        id,\n        type_name,\n        wfr_name,\n        wfr_id,\n        wfl_id,\n        wfv_id,\n        version,\n        start as start_datetime,\n        \"end\" as end_datetime,\n        end_status,\n        \"input\" as input_json,\n        \"output\" as output_json,\n        portal_run_id\n    from\n        \"orcavault\".\"ods\".\"data_portal_workflow\"\n    \n    where\n        cast(start as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_workflow_run_portal\" )\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(portal_run_id as bytea)), 'hex') as workflow_run_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'data_portal_workflow') as record_source,\n        encode(sha256(concat(\n                id,\n                type_name,\n                wfr_name,\n                wfr_id,\n                wfl_id,\n                wfv_id,\n                version,\n                start_datetime,\n                end_datetime,\n                end_status\n        )::bytea), 'hex') as hash_diff,\n        id,\n        type_name,\n        wfr_name,\n        wfr_id,\n        wfl_id,\n        wfv_id,\n        version,\n        start_datetime,\n        end_datetime,\n        end_status,\n        input_json,\n        output_json\n    from\n        source\n\n),\n\nfinal as (\n\n    select\n        cast(workflow_run_hk as char(64)) as workflow_run_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(id as bigint) as id,\n        cast(type_name as varchar(255)) as type_name,\n        cast(wfr_name as text) as wfr_name,\n        cast(wfr_id as varchar(255)) as wfr_id,\n        cast(wfl_id as varchar(255)) as wfl_id,\n        cast(wfv_id as varchar(255)) as wfv_id,\n        cast(version as varchar(255)) as version,\n        cast(start_datetime as timestamptz) as start_datetime,\n        cast(end_datetime as timestamptz) as end_datetime,\n        cast(end_status as varchar(255)) as end_status,\n        cast(input_json as jsonb) as input_json,\n        cast(output_json as jsonb) as output_json\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_workflow_run_portal\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.102014Z", "completed_at": "2025-03-23T22:53:00.108355Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.108909Z", "completed_at": "2025-03-23T22:53:00.108911Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011961936950683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_experiment", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select experiment_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select experiment_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n\n),\n\ncleaned as (\n\n    select\n        distinct trim(experiment_id) as experiment_id\n    from\n        source\n    where\n        experiment_id is not null and experiment_id <> ''\n\n),\n\ndifferentiated as (\n\n    select experiment_id from cleaned\n    \n    except\n    select experiment_id from \"orcavault\".\"dcl\".\"hub_experiment\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(experiment_id as bytea)), 'hex') as experiment_hk,\n        experiment_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(experiment_hk as char(64)) as experiment_hk,\n        cast(experiment_id as varchar(255)) as experiment_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_experiment\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.105112Z", "completed_at": "2025-03-23T22:53:00.109174Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.109805Z", "completed_at": "2025-03-23T22:53:00.109808Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0055081844329833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_external_sample", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select external_sample_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select external_sample_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select external_sample_id from \"orcavault\".\"ods\".\"metadata_manager_sample\"\n    union\n    select external_sample_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select external_sample_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where external_sample_id is not null and external_sample_id <> ''\n\n),\n\ndifferentiated as (\n\n    select external_sample_id from cleaned\n    \n    except\n    select external_sample_id from \"orcavault\".\"dcl\".\"hub_external_sample\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(external_sample_id as bytea)), 'hex') as external_sample_hk,\n        external_sample_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(external_sample_hk as char(64)) as external_sample_hk,\n        cast(external_sample_id as varchar(255)) as external_sample_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_external_sample\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.113035Z", "completed_at": "2025-03-23T22:53:00.118752Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.121595Z", "completed_at": "2025-03-23T22:53:00.121598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012159109115600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_internal_subject", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select subject_id as internal_subject_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select subject_id as internal_subject_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select individual_id as internal_subject_id from \"orcavault\".\"ods\".\"metadata_manager_individual\"\n    union\n    select subject_id as internal_subject_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select subject_id as internal_subject_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where internal_subject_id is not null and internal_subject_id <> ''\n\n),\n\ndifferentiated as (\n\n    select internal_subject_id from cleaned\n    \n    except\n    select internal_subject_id from \"orcavault\".\"dcl\".\"hub_internal_subject\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(internal_subject_id as bytea)), 'hex') as internal_subject_hk,\n        internal_subject_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(internal_subject_hk as char(64)) as internal_subject_hk,\n        cast(internal_subject_id as varchar(255)) as internal_subject_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_internal_subject\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.110632Z", "completed_at": "2025-03-23T22:53:00.121414Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.121894Z", "completed_at": "2025-03-23T22:53:00.121897Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.012621879577636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_external_subject", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select external_subject_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select external_subject_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select subject_id as external_subject_id from \"orcavault\".\"ods\".\"metadata_manager_subject\"\n    union\n    select external_subject_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select external_subject_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where external_subject_id is not null and external_subject_id <> ''\n\n),\n\ndifferentiated as (\n\n    select external_subject_id from cleaned\n    \n    except\n    select external_subject_id from \"orcavault\".\"dcl\".\"hub_external_subject\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(external_subject_id as bytea)), 'hex') as external_subject_hk,\n        external_subject_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(external_subject_hk as char(64)) as external_subject_hk,\n        cast(external_subject_id as varchar(255)) as external_subject_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_external_subject\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.115870Z", "completed_at": "2025-03-23T22:53:00.122475Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.123855Z", "completed_at": "2025-03-23T22:53:00.123881Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013818025588989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_library", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select library_id from \"orcavault\".\"ods\".\"metadata_manager_library\"\n    union\n    select library_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where library_id is not null and library_id <> ''\n\n),\n\ndifferentiated as (\n\n    select library_id from cleaned\n    \n    except\n    select library_id from \"orcavault\".\"dcl\".\"hub_library\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        library_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(library_hk as char(64)) as library_hk,\n        cast(library_id as varchar(255)) as library_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_library\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.118941Z", "completed_at": "2025-03-23T22:53:00.122773Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.124416Z", "completed_at": "2025-03-23T22:53:00.124419Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008829116821289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_owner", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select project_owner as owner_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select project_owner as owner_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select contact_id as owner_id from \"orcavault\".\"ods\".\"metadata_manager_contact\"\n    union\n    select project_owner as owner_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select project_owner as owner_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where owner_id is not null and owner_id <> ''\n\n),\n\ndifferentiated as (\n\n    select owner_id from cleaned\n    \n    except\n    select owner_id from \"orcavault\".\"dcl\".\"hub_owner\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(owner_id as bytea)), 'hex') as owner_hk,\n        owner_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(owner_hk as char(64)) as owner_hk,\n        cast(owner_id as varchar(255)) as owner_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_owner\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.125797Z", "completed_at": "2025-03-23T22:53:00.135954Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.138045Z", "completed_at": "2025-03-23T22:53:00.138049Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014854907989501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_project", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select project_name as project_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select project_name as project_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select project_id from \"orcavault\".\"ods\".\"metadata_manager_project\"\n    union\n    select project_name as project_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select project_name as project_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where project_id is not null and project_id <> ''\n\n),\n\ndifferentiated as (\n\n    select project_id from cleaned\n    \n    except\n    select project_id from \"orcavault\".\"dcl\".\"hub_project\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(project_id as bytea)), 'hex') as project_hk,\n        project_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(project_hk as char(64)) as project_hk,\n        cast(project_id as varchar(255)) as project_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_project\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.129305Z", "completed_at": "2025-03-23T22:53:00.138386Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.138989Z", "completed_at": "2025-03-23T22:53:00.138992Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.014320135116577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.hub_sample", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select sample_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select sample_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select sample_id from \"orcavault\".\"ods\".\"metadata_manager_sample\"\n    union\n    select sample_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select sample_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select * from source where sample_id is not null and sample_id <> ''\n\n),\n\ndifferentiated as (\n\n    select sample_id from cleaned\n    \n    except\n    select sample_id from \"orcavault\".\"dcl\".\"hub_sample\"\n    \n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(cast(sample_id as bytea)), 'hex') as sample_hk,\n        sample_id,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as last_seen_datetime\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(sample_hk as char(64)) as sample_hk,\n        cast(sample_id as varchar(255)) as sample_id,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(last_seen_datetime as timestamptz) as last_seen_datetime\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"hub_sample\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.132573Z", "completed_at": "2025-03-23T22:53:00.138800Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.139673Z", "completed_at": "2025-03-23T22:53:00.139676Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010820150375366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_s3object_current", "compiled": true, "compiled_code": "\n\nwith incremental as (\n\n    select\n        *\n    from\n        \"orcavault\".\"dcl\".\"sat_s3object_history\"\n    \n    where\n        cast(event_time as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_s3object_current\" )\n    \n\n),\n\nhistory as (\n\n    select\n        h.*,\n        row_number() over (partition by h.s3object_hk, cast(h.event_time as date) order by cast(h.event_time as date) desc) as rank_by_daily\n    from\n        \"orcavault\".\"dcl\".\"sat_s3object_history\" h\n        right outer join incremental i on i.s3object_hk = h.s3object_hk\n\n),\n\ndaily as (\n\n    select * from history where rank_by_daily = 1\n\n),\n\ngrouped as (\n\n    select\n        *,\n        row_number() over (partition by s3object_hk order by cast(event_time as date) desc) as rank_by_group\n    from daily\n\n),\n\ntransformed as (\n\n    select\n        s3object_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        record_source,\n        encode(sha256(concat(\n            s3_object_id,\n            \"size\",\n            e_tag,\n            sha256,\n            last_modified_date,\n            storage_class,\n            attributes,\n            ingest_id,\n            reason\n        )::bytea), 'hex') as hash_diff,\n        s3_object_id,\n        \"size\",\n        e_tag,\n        sha256,\n        last_modified_date,\n        storage_class,\n        attributes,\n        ingest_id,\n        reason,\n        cast(event_time as timestamptz) as effective_from,\n        case\n            when (rank_by_group = 1) then\n                cast('9999-12-31' as date)\n            else\n                lag(event_time) over (partition by s3object_hk order by rank_by_group)\n            end as effective_to,\n        case when (rank_by_group = 1) then 1 else 0 end as is_current,\n        case when (event_type = 'Deleted') then 1 else 0 end as is_deleted\n    from\n        grouped\n\n),\n\nfinal as (\n\n    select\n        cast(s3object_hk as char(64)) as s3object_hk,\n        cast(hash_diff as char(64)) as s3object_sq,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(s3_object_id as uuid) as s3_object_id,\n        cast(\"size\" as bigint) as \"size\",\n        cast(e_tag as varchar(255)) as e_tag,\n        cast(sha256 as text) as sha256,\n        cast(last_modified_date as timestamptz) as last_modified_date,\n        cast(storage_class as varchar(255)) as storage_class,\n        cast(attributes as jsonb) as attributes,\n        cast(ingest_id as uuid) as ingest_id,\n        cast(reason as varchar(255)) as reason,\n        cast(effective_from as timestamptz) as effective_from,\n        cast(effective_to as timestamptz) as effective_to,\n        cast(is_current as smallint) as is_current,\n        cast(is_deleted as smallint) as is_deleted\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_s3object_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.136160Z", "completed_at": "2025-03-23T22:53:00.139519Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.140350Z", "completed_at": "2025-03-23T22:53:00.140352Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01126408576965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_individual_mm", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        individual_id as internal_subject_id,\n        orcabus_id,\n        source\n    from\n        \"orcavault\".\"ods\".\"metadata_manager_individual\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(internal_subject_id, E'[\\\\n\\\\r]+', '', 'g')) as internal_subject_id,\n        trim(regexp_replace(orcabus_id, E'[\\\\n\\\\r]+', '', 'g')) as orcabus_id,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source\n    from\n        source\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(internal_subject_id as bytea)), 'hex') as internal_subject_hk,\n        encode(sha256(concat(orcabus_id, source)::bytea), 'hex') as hash_diff,\n        orcabus_id,\n        source\n    from\n        cleaned\n\n),\n\ndifferentiated as (\n\n    select\n        internal_subject_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        internal_subject_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_individual_mm\"\n    \n\n),\n\ntransformed as (\n\n    select\n        internal_subject_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'metadata_manager_individual') as record_source,\n        hash_diff,\n        orcabus_id,\n        source\n    from\n        encoded\n    \n    where\n        internal_subject_hk in (select internal_subject_hk from differentiated)\n    \n\n),\n\nfinal as (\n\n    select\n        cast(internal_subject_hk as char(64)) as internal_subject_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(orcabus_id as varchar(255)) as orcabus_id,\n        cast(source as varchar(255)) as source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_individual_mm\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.143797Z", "completed_at": "2025-03-23T22:53:00.149696Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.154415Z", "completed_at": "2025-03-23T22:53:00.154419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015141963958740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_internal_to_external_subject", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select subject_id as internal_subject_id, external_subject_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select subject_id as internal_subject_id, external_subject_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select idv.individual_id as internal_subject_id, sbj.subject_id as external_subject_id from \"orcavault\".\"ods\".\"metadata_manager_subject\" as sbj\n        join \"orcavault\".\"ods\".\"metadata_manager_subjectindividuallink\" as lnk on lnk.subject_orcabus_id = sbj.orcabus_id\n        join \"orcavault\".\"ods\".\"metadata_manager_individual\" as idv on lnk.individual_orcabus_id = idv.orcabus_id\n    union\n    select subject_id as internal_subject_id, external_subject_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select subject_id as internal_subject_id, external_subject_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct internal_subject_id, trim(external_subject_id) as external_subject_id\n    from\n        source\n    where\n        (internal_subject_id is not null and internal_subject_id <> '') and\n        (external_subject_id is not null and external_subject_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(external_subject_id as bytea)), 'hex') as external_subject_hk,\n        encode(sha256(cast(internal_subject_id as bytea)), 'hex') as internal_subject_hk\n    from\n        cleaned\n    \n    except\n    select\n        external_subject_hk,\n        internal_subject_hk\n    from\n        \"orcavault\".\"dcl\".\"link_internal_to_external_subject\"\n    \n\n),\n\ntransformed as (\n\n    select\n        external_subject_hk,\n        internal_subject_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(external_subject_hk, internal_subject_hk)::bytea), 'hex') as char(64)) as internal_external_subject_hk,\n        cast(external_subject_hk as char(64)) as external_subject_hk,\n        cast(internal_subject_hk as char(64)) as internal_subject_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_internal_to_external_subject\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.147455Z", "completed_at": "2025-03-23T22:53:00.154760Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.155149Z", "completed_at": "2025-03-23T22:53:00.155153Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011582136154174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_subject_mm", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        subject_id as external_subject_id,\n        orcabus_id\n    from\n        \"orcavault\".\"ods\".\"metadata_manager_subject\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(external_subject_id, E'[\\\\n\\\\r]+', '', 'g')) as external_subject_id,\n        trim(regexp_replace(orcabus_id, E'[\\\\n\\\\r]+', '', 'g')) as orcabus_id\n    from\n        source\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(external_subject_id as bytea)), 'hex') as external_subject_hk,\n        encode(sha256(concat(orcabus_id)::bytea), 'hex') as hash_diff,\n        orcabus_id\n    from\n        cleaned\n\n),\n\ndifferentiated as (\n\n    select\n        external_subject_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        external_subject_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_subject_mm\"\n    \n\n),\n\ntransformed as (\n\n    select\n        external_subject_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'metadata_manager_subject') as record_source,\n        hash_diff,\n        orcabus_id\n    from\n        encoded\n    \n    where\n        external_subject_hk in (select external_subject_hk from differentiated)\n    \n\n),\n\nfinal as (\n\n    select\n        cast(external_subject_hk as char(64)) as external_subject_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(orcabus_id as varchar(255)) as orcabus_id\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_subject_mm\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.149854Z", "completed_at": "2025-03-23T22:53:00.155907Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.156547Z", "completed_at": "2025-03-23T22:53:00.156550Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010191202163696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_experiment", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, experiment_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, experiment_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, experiment_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (experiment_id is not null and experiment_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(experiment_id as bytea)), 'hex') as experiment_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        experiment_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_experiment\"\n    \n\n),\n\ntransformed as (\n\n    select\n        experiment_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(experiment_hk, library_hk)::bytea), 'hex') as char(64)) as library_experiment_hk,\n        cast(experiment_hk as char(64)) as experiment_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_experiment\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.151817Z", "completed_at": "2025-03-23T22:53:00.156053Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.156810Z", "completed_at": "2025-03-23T22:53:00.156813Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01007390022277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_external_sample", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, external_sample_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, external_sample_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select lib.library_id as library_id, smp.external_sample_id as external_sample_id from \"orcavault\".\"ods\".\"metadata_manager_library\" as lib\n        join \"orcavault\".\"ods\".\"metadata_manager_sample\" as smp on smp.orcabus_id = lib.sample_orcabus_id\n    union\n    select library_id, external_sample_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id, external_sample_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, trim(external_sample_id) as external_sample_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (external_sample_id is not null and external_sample_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(external_sample_id as bytea)), 'hex') as external_sample_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        external_sample_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_external_sample\"\n    \n\n),\n\ntransformed as (\n\n    select\n        external_sample_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(external_sample_hk, library_hk)::bytea), 'hex') as char(64)) as library_external_sample_hk,\n        cast(external_sample_hk as char(64)) as external_sample_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_external_sample\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.157087Z", "completed_at": "2025-03-23T22:53:00.163284Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.165507Z", "completed_at": "2025-03-23T22:53:00.165511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010043859481811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_external_subject", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, external_subject_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, external_subject_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select lib.library_id as library_id, sbj.subject_id as external_subject_id from \"orcavault\".\"ods\".\"metadata_manager_library\" as lib\n        join \"orcavault\".\"ods\".\"metadata_manager_subject\" as sbj on sbj.orcabus_id = lib.subject_orcabus_id\n    union\n    select library_id, external_subject_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id, external_subject_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, trim(external_subject_id) as external_subject_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (external_subject_id is not null and external_subject_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(external_subject_id as bytea)), 'hex') as external_subject_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        external_subject_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_external_subject\"\n    \n\n),\n\ntransformed as (\n\n    select\n        external_subject_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(external_subject_hk, library_hk)::bytea), 'hex') as char(64)) as library_external_subject_hk,\n        cast(external_subject_hk as char(64)) as external_subject_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_external_subject\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.160061Z", "completed_at": "2025-03-23T22:53:00.165798Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.167995Z", "completed_at": "2025-03-23T22:53:00.167998Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011676788330078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_internal_subject", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, subject_id as internal_subject_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, subject_id as internal_subject_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select lib.library_id as library_id, idv.individual_id as internal_subject_id from \"orcavault\".\"ods\".\"metadata_manager_library\" as lib\n        join \"orcavault\".\"ods\".\"metadata_manager_subject\" as sbj on sbj.orcabus_id = lib.subject_orcabus_id\n        join \"orcavault\".\"ods\".\"metadata_manager_subjectindividuallink\" as lnk on lnk.subject_orcabus_id = sbj.orcabus_id\n        join \"orcavault\".\"ods\".\"metadata_manager_individual\" as idv on idv.orcabus_id = lnk.individual_orcabus_id\n    union\n    select library_id, subject_id as internal_subject_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id, subject_id as internal_subject_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, internal_subject_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (internal_subject_id is not null and internal_subject_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(internal_subject_id as bytea)), 'hex') as internal_subject_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        internal_subject_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_internal_subject\"\n    \n\n),\n\ntransformed as (\n\n    select\n        internal_subject_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(internal_subject_hk, library_hk)::bytea), 'hex') as char(64)) as library_internal_subject_hk,\n        cast(internal_subject_hk as char(64)) as internal_subject_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_internal_subject\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.163621Z", "completed_at": "2025-03-23T22:53:00.168680Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.169209Z", "completed_at": "2025-03-23T22:53:00.169212Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006586790084838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_ownership", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, project_owner as owner_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, project_owner as owner_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select library_id, project_owner as owner_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id, project_owner as owner_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, owner_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (owner_id is not null and owner_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(owner_id as bytea)), 'hex') as owner_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        owner_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_ownership\"\n    \n\n),\n\ntransformed as (\n\n    select\n        owner_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(owner_hk, library_hk)::bytea), 'hex') as char(64)) as library_owner_hk,\n        cast(owner_hk as char(64)) as owner_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_ownership\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.165957Z", "completed_at": "2025-03-23T22:53:00.169466Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.172567Z", "completed_at": "2025-03-23T22:53:00.172574Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009745121002197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_sequencing_run", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, instrument_run_id as sequencing_run_id from \"orcavault\".\"ods\".\"data_portal_libraryrun\"\n    union\n    select library_id, illumina_id as sequencing_run_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select library_id, illumina_id as sequencing_run_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, sequencing_run_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (sequencing_run_id is not null and sequencing_run_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(sequencing_run_id as bytea)), 'hex') as sequencing_run_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        sequencing_run_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_sequencing_run\"\n    \n\n),\n\ntransformed as (\n\n    select\n        sequencing_run_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(sequencing_run_hk, library_hk)::bytea), 'hex') as char(64)) as library_sequencing_run_hk,\n        cast(sequencing_run_hk as char(64)) as sequencing_run_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_sequencing_run\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.169620Z", "completed_at": "2025-03-23T22:53:00.175189Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.175711Z", "completed_at": "2025-03-23T22:53:00.175714Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007430076599121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_workflow_run", "compiled": true, "compiled_code": "\n\nwith source1 as (\n\n    select\n        wfr.portal_run_id as portal_run_id,\n        lbr.library_id as library_id\n    from \"orcavault\".\"ods\".\"data_portal_workflow\" wfr\n        join \"orcavault\".\"ods\".\"data_portal_libraryrun_workflows\" lnk on lnk.workflow_id = wfr.id\n        join \"orcavault\".\"ods\".\"data_portal_libraryrun\" lbr on lnk.libraryrun_id = lbr.id\n    \n    where\n        cast(start as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"link_library_workflow_run\" )\n    \n\n),\n\nsource2 as (\n\n    select\n        wfr.portal_run_id as portal_run_id,\n        lib.library_id as library_id\n    from \"orcavault\".\"ods\".\"workflow_manager_workflowrun\" wfr\n        join \"orcavault\".\"ods\".\"workflow_manager_libraryassociation\" lnk on lnk.workflow_run_id = wfr.orcabus_id\n        join \"orcavault\".\"ods\".\"workflow_manager_library\" lib on lnk.library_id = lib.orcabus_id\n    \n    where\n        cast(lnk.association_date as timestamptz) > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"link_library_workflow_run\" )\n    \n\n),\n\ncombined as (\n\n    select distinct portal_run_id, library_id from source1\n    union\n    select distinct portal_run_id, library_id from source2\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(portal_run_id as bytea)), 'hex') as workflow_run_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        combined\n\n),\n\ntransformed as (\n\n    select\n        cast(encode(sha256(concat(workflow_run_hk, library_hk)::bytea), 'hex') as char(64)) as library_workflow_run_hk,\n        workflow_run_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'portal_workflow_manager') as record_source\n    from\n        encoded\n\n),\n\nfinal as (\n\n    select\n        cast(library_workflow_run_hk as char(64)) as library_workflow_run_hk,\n        cast(workflow_run_hk as char(64)) as workflow_run_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_workflow_run\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.172860Z", "completed_at": "2025-03-23T22:53:00.175954Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.178134Z", "completed_at": "2025-03-23T22:53:00.178137Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009152889251708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_glab", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select distinct\n        record_source,\n        library_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source,\n        truseq_index\n    from\n        \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n\n),\n\ncleaned as (\n\n    select\n        record_source,\n        row_number() over (partition by library_id order by phenotype) as rank,\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source,\n        trim(regexp_replace(truseq_index, E'[\\\\n\\\\r]+', '', 'g')) as truseq_index\n    from\n        source\n    where\n        library_id is not null or library_id <> ''\n\n),\n\nencoded as (\n\n    select\n        record_source,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        encode(sha256(concat(workflow, phenotype, type, assay, quality, source, truseq_index)::bytea), 'hex') as hash_diff,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source,\n        truseq_index\n    from\n        cleaned\n    where\n        rank = 1\n\n),\n\ndifferentiated as (\n\n    select\n        library_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        library_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_library_glab\"\n    \n\n),\n\ntransformed as (\n\n    select\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        record_source,\n        hash_diff,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source,\n        truseq_index\n    from\n        encoded\n    \n    where\n        library_hk in (select library_hk from differentiated)\n    \n\n),\n\nfinal as (\n\n    select\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(workflow as varchar(255)) as workflow,\n        cast(phenotype as varchar(255)) as phenotype,\n        cast(type as varchar(255)) as type,\n        cast(assay as varchar(255)) as assay,\n        cast(quality as varchar(255)) as quality,\n        cast(source as varchar(255)) as source,\n        cast(truseq_index as varchar(255)) as truseq_index\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_glab\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.176095Z", "completed_at": "2025-03-23T22:53:00.180798Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.183295Z", "completed_at": "2025-03-23T22:53:00.183298Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00860285758972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_glims", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        record_source,\n        library_id,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        illumina_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source\n    from\n        \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        record_source,\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        \"timestamp\",\n        row_number() over (partition by library_id, \"timestamp\" order by \"timestamp\" desc, illumina_id desc, workflow desc) as rank,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source\n    from\n        source\n    where\n        library_id is not null or library_id <> ''\n\n),\n\ndifferentiated as (\n\n    select\n        *\n    from\n        cleaned\n    where\n        rank = 1\n    \n        and cast(\"timestamp\" as timestamptz) + time '11:00' > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_library_glims\" )\n    \n\n),\n\nencoded as (\n\n    select\n        record_source,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        encode(sha256(concat(\"timestamp\", workflow, phenotype, type, assay, quality, source)::bytea), 'hex') as hash_diff,\n        \"timestamp\",\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source\n    from\n        differentiated\n\n),\n\ntransformed as (\n\n    select\n        library_hk,\n        cast(\"timestamp\" as timestamptz) + time '11:00' as load_datetime,\n        record_source,\n        hash_diff,\n        \"timestamp\",\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source\n    from\n        encoded\n\n),\n\nfinal as (\n\n    select\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        cast(workflow as varchar(255)) as workflow,\n        cast(phenotype as varchar(255)) as phenotype,\n        cast(type as varchar(255)) as type,\n        cast(assay as varchar(255)) as assay,\n        cast(quality as varchar(255)) as quality,\n        cast(source as varchar(255)) as source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_glims\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.178426Z", "completed_at": "2025-03-23T22:53:00.183143Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.183738Z", "completed_at": "2025-03-23T22:53:00.183741Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.00824284553527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_mm", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        library_id,\n        orcabus_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality\n    from\n        \"orcavault\".\"ods\".\"metadata_manager_library\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        trim(regexp_replace(orcabus_id, E'[\\\\n\\\\r]+', '', 'g')) as orcabus_id,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality\n    from\n        source\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        encode(sha256(concat(orcabus_id, workflow, phenotype, type, assay, quality)::bytea), 'hex') as hash_diff,\n        orcabus_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality\n    from\n        cleaned\n\n),\n\ndifferentiated as (\n\n    select\n        library_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        library_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_library_mm\"\n    \n\n),\n\ntransformed as (\n\n    select\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'metadata_manager') as record_source,\n        hash_diff,\n        orcabus_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality\n    from\n        encoded\n    \n    where\n        library_hk in (select library_hk from differentiated)\n    \n\n),\n\nfinal as (\n\n    select\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(orcabus_id as varchar(255)) as orcabus_id,\n        cast(workflow as varchar(255)) as workflow,\n        cast(phenotype as varchar(255)) as phenotype,\n        cast(type as varchar(255)) as type,\n        cast(assay as varchar(255)) as assay,\n        cast(quality as varchar(255)) as quality\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_mm\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.181136Z", "completed_at": "2025-03-23T22:53:00.186107Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.186611Z", "completed_at": "2025-03-23T22:53:00.186614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006403923034667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_plab", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        library_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source,\n        truseqindex\n    from\n        \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source,\n        trim(regexp_replace(truseqindex, E'[\\\\n\\\\r]+', '', 'g')) as truseqindex\n    from\n        source\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        encode(sha256(concat(workflow, phenotype, type, assay, quality, source, truseqindex)::bytea), 'hex') as hash_diff,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source,\n        truseqindex\n    from\n        cleaned\n\n),\n\ndifferentiated as (\n\n    select\n        library_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        library_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_library_plab\"\n    \n\n),\n\ntransformed as (\n\n    select\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'data_portal_labmetadata') as record_source,\n        hash_diff,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source,\n        truseqindex\n    from\n        encoded\n    \n    where\n        library_hk in (select library_hk from differentiated)\n    \n\n),\n\nfinal as (\n    select\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(workflow as varchar(255)) as workflow,\n        cast(phenotype as varchar(255)) as phenotype,\n        cast(type as varchar(255)) as type,\n        cast(assay as varchar(255)) as assay,\n        cast(quality as varchar(255)) as quality,\n        cast(source as varchar(255)) as source,\n        cast(truseqindex as varchar(255)) as truseqindex\n    from\n        transformed\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_plab\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.184162Z", "completed_at": "2025-03-23T22:53:00.190059Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.192797Z", "completed_at": "2025-03-23T22:53:00.192801Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011877059936523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_plims", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        library_id,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        illumina_id,\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source\n    from\n        \"orcavault\".\"ods\".\"data_portal_limsrow\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        \"timestamp\",\n        row_number() over (partition by library_id, \"timestamp\" order by \"timestamp\" desc, illumina_id desc) as rank,\n        trim(regexp_replace(workflow, E'[\\\\n\\\\r]+', '', 'g')) as workflow,\n        trim(regexp_replace(phenotype, E'[\\\\n\\\\r]+', '', 'g')) as phenotype,\n        trim(regexp_replace(type, E'[\\\\n\\\\r]+', '', 'g')) as type,\n        trim(regexp_replace(assay, E'[\\\\n\\\\r]+', '', 'g')) as assay,\n        trim(regexp_replace(quality, E'[\\\\n\\\\r]+', '', 'g')) as quality,\n        trim(regexp_replace(source, E'[\\\\n\\\\r]+', '', 'g')) as source\n    from\n        source\n\n),\n\ndifferentiated as (\n\n    select\n        *\n    from\n        cleaned\n    where\n        rank = 1\n    \n        and cast(\"timestamp\" as timestamptz) + time '11:00' > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_library_plims\" )\n    \n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        encode(sha256(concat(\"timestamp\", workflow, phenotype, type, assay, quality, source)::bytea), 'hex') as hash_diff,\n        \"timestamp\",\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source\n    from\n        differentiated\n\n),\n\ntransformed as (\n\n    select\n        library_hk,\n        cast(\"timestamp\" as timestamptz) + time '11:00' as load_datetime,\n        (select 'data_portal_limsrow') as record_source,\n        hash_diff,\n        \"timestamp\",\n        workflow,\n        phenotype,\n        type,\n        assay,\n        quality,\n        source\n    from\n        encoded\n\n),\n\nfinal as (\n\n    select\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        cast(workflow as varchar(255)) as workflow,\n        cast(phenotype as varchar(255)) as phenotype,\n        cast(type as varchar(255)) as type,\n        cast(assay as varchar(255)) as assay,\n        cast(quality as varchar(255)) as quality,\n        cast(source as varchar(255)) as source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_plims\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.187032Z", "completed_at": "2025-03-23T22:53:00.193528Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.194221Z", "completed_at": "2025-03-23T22:53:00.194224Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008356809616088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_owner_contact", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        *\n    from\n        \"orcavault\".\"ods\".\"metadata_manager_contact\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(contact_id, E'[\\\\n\\\\r]+', '', 'g')) as contact_id,\n        trim(regexp_replace(orcabus_id, E'[\\\\n\\\\r]+', '', 'g')) as orcabus_id,\n        trim(regexp_replace(name, E'[\\\\n\\\\r]+', '', 'g')) as name,\n        trim(regexp_replace(description, E'[\\\\n\\\\r]+', '', 'g')) as description,\n        trim(regexp_replace(email, E'[\\\\n\\\\r]+', '', 'g')) as email\n    from\n        source\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(contact_id as bytea)), 'hex') as owner_hk,\n        encode(sha256(concat(orcabus_id, name, description, email)::bytea), 'hex') as hash_diff,\n        orcabus_id,\n        name,\n        description,\n        email\n    from\n        cleaned\n\n),\n\ndifferentiated as (\n\n    select\n        owner_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        owner_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_owner_contact\"\n    \n\n),\n\ntransformed as (\n\n    select\n        owner_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'metadata_manager_contact') as record_source,\n        hash_diff,\n        orcabus_id,\n        name,\n        description,\n        email\n    from\n        encoded\n    \n    where\n        owner_hk in (select owner_hk from differentiated)\n    \n\n),\n\nfinal as (\n\n    select\n        cast(owner_hk as char(64)) as owner_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(orcabus_id as varchar(255)) as orcabus_id,\n        cast(name as varchar(255)) as name,\n        cast(description as varchar(255)) as description,\n        cast(email as varchar(255)) as email\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_owner_contact\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.190422Z", "completed_at": "2025-03-23T22:53:00.194069Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.196851Z", "completed_at": "2025-03-23T22:53:00.196853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010630130767822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_project", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, project_name as project_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, project_name as project_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select lib.library_id as library_id, prj.project_id as project_id from \"orcavault\".\"ods\".\"metadata_manager_library\" as lib\n        join \"orcavault\".\"ods\".\"metadata_manager_libraryprojectlink\" as lnk on lnk.library_orcabus_id = lib.orcabus_id\n        join \"orcavault\".\"ods\".\"metadata_manager_project\" as prj on lnk.project_orcabus_id = prj.orcabus_id\n    union\n    select library_id, project_name as project_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id, project_name as project_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, project_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (project_id is not null and project_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(project_id as bytea)), 'hex') as project_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        project_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_project\"\n    \n\n),\n\ntransformed as (\n\n    select\n        project_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(project_hk, library_hk)::bytea), 'hex') as char(64)) as library_project_hk,\n        cast(project_hk as char(64)) as project_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_project\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.194476Z", "completed_at": "2025-03-23T22:53:00.199726Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.200236Z", "completed_at": "2025-03-23T22:53:00.200238Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0071642398834228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_project_ownership", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select project_name as project_id, project_owner as owner_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select project_name as project_id, project_owner as owner_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select project_id, contact_id as owner_id from \"orcavault\".\"ods\".\"metadata_manager_project\" as prj\n        join \"orcavault\".\"ods\".\"metadata_manager_projectcontactlink\" as lnk on lnk.project_orcabus_id = prj.orcabus_id\n        join \"orcavault\".\"ods\".\"metadata_manager_contact\" as cnt on lnk.contact_orcabus_id = cnt.orcabus_id\n    union\n    select project_name as project_id, project_owner as owner_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select project_name as project_id, project_owner as owner_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct trim(project_id) as project_id, trim(owner_id) as owner_id\n    from\n        source\n    where\n        (project_id is not null and project_id <> '') and\n        (owner_id is not null and owner_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(owner_id as bytea)), 'hex') as owner_hk,\n        encode(sha256(cast(project_id as bytea)), 'hex') as project_hk\n    from\n        cleaned\n    \n    except\n    select\n        owner_hk,\n        project_hk\n    from\n        \"orcavault\".\"dcl\".\"link_project_ownership\"\n    \n\n),\n\ntransformed as (\n\n    select\n        owner_hk,\n        project_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(owner_hk, project_hk)::bytea), 'hex') as char(64)) as project_owner_hk,\n        cast(owner_hk as char(64)) as owner_hk,\n        cast(project_hk as char(64)) as project_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_project_ownership\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.197310Z", "completed_at": "2025-03-23T22:53:00.200483Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.202983Z", "completed_at": "2025-03-23T22:53:00.202986Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009137868881225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_project_mm", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        *\n    from\n        \"orcavault\".\"ods\".\"metadata_manager_project\"\n\n),\n\ncleaned as (\n\n    select\n        trim(regexp_replace(project_id, E'[\\\\n\\\\r]+', '', 'g')) as project_id,\n        trim(regexp_replace(orcabus_id, E'[\\\\n\\\\r]+', '', 'g')) as orcabus_id,\n        trim(regexp_replace(name, E'[\\\\n\\\\r]+', '', 'g')) as name,\n        trim(regexp_replace(description, E'[\\\\n\\\\r]+', '', 'g')) as description\n    from\n        source\n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(project_id as bytea)), 'hex') as project_hk,\n        encode(sha256(concat(orcabus_id, name, description)::bytea), 'hex') as hash_diff,\n        orcabus_id,\n        name,\n        description\n    from\n        cleaned\n\n),\n\ndifferentiated as (\n\n    select\n        project_hk,\n        hash_diff\n    from\n        encoded\n    \n    except\n    select\n        project_hk,\n        hash_diff\n    from\n        \"orcavault\".\"dcl\".\"sat_project_mm\"\n    \n\n),\n\ntransformed as (\n\n    select\n        project_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'metadata_manager_project') as record_source,\n        hash_diff,\n        orcabus_id,\n        name,\n        description\n    from\n        encoded\n    \n    where\n        project_hk in (select project_hk from differentiated)\n    \n\n),\n\nfinal as (\n\n    select\n        cast(project_hk as char(64)) as project_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(orcabus_id as varchar(255)) as orcabus_id,\n        cast(name as varchar(255)) as name,\n        cast(description as varchar(255)) as description\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_project_mm\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.200784Z", "completed_at": "2025-03-23T22:53:00.206363Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.208487Z", "completed_at": "2025-03-23T22:53:00.208489Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008980989456176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_internal_to_external_sample", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select sample_id, external_sample_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select sample_id, external_sample_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select sample_id, external_sample_id from \"orcavault\".\"ods\".\"metadata_manager_sample\"\n    union\n    select sample_id, external_sample_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select sample_id, external_sample_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct sample_id, trim(external_sample_id) as external_sample_id\n    from\n        source\n    where\n        (sample_id is not null and sample_id <> '') and\n        (external_sample_id is not null and external_sample_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(external_sample_id as bytea)), 'hex') as external_sample_hk,\n        encode(sha256(cast(sample_id as bytea)), 'hex') as sample_hk\n    from\n        cleaned\n    \n    except\n    select\n        external_sample_hk,\n        sample_hk\n    from\n        \"orcavault\".\"dcl\".\"link_internal_to_external_sample\"\n    \n\n),\n\ntransformed as (\n\n    select\n        external_sample_hk,\n        sample_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(external_sample_hk, sample_hk)::bytea), 'hex') as char(64)) as internal_external_sample_hk,\n        cast(external_sample_hk as char(64)) as external_sample_hk,\n        cast(sample_hk as char(64)) as sample_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_internal_to_external_sample\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.203251Z", "completed_at": "2025-03-23T22:53:00.208160Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.208759Z", "completed_at": "2025-03-23T22:53:00.208761Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008903741836547852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.link_library_sample", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select library_id, sample_id from \"orcavault\".\"ods\".\"data_portal_limsrow\"\n    union\n    select library_id, sample_id from \"orcavault\".\"ods\".\"data_portal_labmetadata\"\n    union\n    select library_id, smp.sample_id as sample_id from \"orcavault\".\"ods\".\"metadata_manager_library\" as lib\n        join \"orcavault\".\"ods\".\"metadata_manager_sample\" as smp on lib.sample_orcabus_id = smp.orcabus_id\n    union\n    select library_id, sample_id from \"orcavault\".\"psa\".\"spreadsheet_library_tracking_metadata\"\n    union\n    select library_id, sample_id from \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        distinct library_id, sample_id\n    from\n        source\n    where\n        (library_id is not null and library_id <> '') and\n        (sample_id is not null and sample_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        encode(sha256(cast(sample_id as bytea)), 'hex') as sample_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk\n    from\n        cleaned\n    \n    except\n    select\n        sample_hk,\n        library_hk\n    from\n        \"orcavault\".\"dcl\".\"link_library_sample\"\n    \n\n),\n\ntransformed as (\n\n    select\n        sample_hk,\n        library_hk,\n        cast('2025-03-23 22:52:58.848938+00:00' as timestamptz) as load_datetime,\n        (select 'lab') as record_source\n    from\n        differentiated\n\n),\n\nfinal as (\n\n    select\n        cast(encode(sha256(concat(sample_hk, library_hk)::bytea), 'hex') as char(64)) as library_sample_hk,\n        cast(sample_hk as char(64)) as sample_hk,\n        cast(library_hk as char(64)) as library_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"link_library_sample\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.206520Z", "completed_at": "2025-03-23T22:53:00.210851Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.211053Z", "completed_at": "2025-03-23T22:53:00.211056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005494117736816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_sequencing_run_glims", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        illumina_id as sequencing_run_id,\n        library_id,\n        record_source,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        run,\n        override_cycles,\n        secondary_analysis,\n        number_fastqs,\n        fastq,\n        results,\n        notes,\n        trello\n    from\n        \"orcavault\".\"psa\".\"spreadsheet_google_lims\"\n\n),\n\ncleaned as (\n\n    select\n        row_number() over (partition by library_id, \"timestamp\" order by \"timestamp\" desc, sequencing_run_id desc) as rank,\n        sequencing_run_id,\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        record_source,\n        \"timestamp\",\n        run,\n        trim(regexp_replace(override_cycles, E'[\\\\n\\\\r]+', '', 'g')) as override_cycles,\n        trim(regexp_replace(secondary_analysis, E'[\\\\n\\\\r]+', '', 'g')) as secondary_analysis,\n        trim(regexp_replace(number_fastqs, E'[\\\\n\\\\r]+', '', 'g')) as number_fastqs,\n        trim(regexp_replace(fastq, E'[\\\\n\\\\r]+', '', 'g')) as fastq,\n        trim(regexp_replace(results, E'[\\\\n\\\\r]+', '', 'g')) as results,\n        trim(regexp_replace(notes, E'[\\\\n\\\\r]+', '', 'g')) as notes,\n        trim(regexp_replace(trello, E'[\\\\n\\\\r]+', '', 'g')) as trello\n    from\n        source\n    where\n        (library_id is not null or library_id <> '') and\n        (sequencing_run_id is not null or sequencing_run_id <> '')\n\n),\n\ndifferentiated as (\n\n    select\n        *\n    from\n        cleaned\n    where\n        rank = 1\n    \n        and cast(\"timestamp\" as timestamptz) + time '11:00' > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_library_sequencing_run_glims\" )\n    \n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(sequencing_run_id as bytea)), 'hex') as sequencing_run_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        record_source,\n        encode(sha256(concat(\"timestamp\", run, override_cycles, secondary_analysis, number_fastqs, fastq, results, notes, trello)::bytea), 'hex') as hash_diff,\n        \"timestamp\",\n        run,\n        override_cycles,\n        secondary_analysis,\n        number_fastqs,\n        fastq,\n        results,\n        notes,\n        trello\n    from\n        differentiated\n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(concat(sequencing_run_hk, library_hk)::bytea), 'hex') as library_sequencing_run_hk,\n        cast(\"timestamp\" as timestamptz) + time '11:00' as load_datetime,\n        record_source,\n        hash_diff,\n        \"timestamp\",\n        run,\n        override_cycles,\n        secondary_analysis,\n        number_fastqs,\n        fastq,\n        results,\n        notes,\n        trello\n    from\n        encoded\n\n),\n\nfinal as (\n\n    select\n        cast(library_sequencing_run_hk as char(64)) as library_sequencing_run_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        cast(run as integer) as run,\n        cast(override_cycles as varchar(255)) as override_cycles,\n        cast(secondary_analysis as varchar(255)) as secondary_analysis,\n        cast(number_fastqs as varchar(255)) as number_fastqs,\n        cast(fastq as text) as fastq,\n        cast(results as text) as results,\n        cast(notes as text) as notes,\n        cast(trello as text) as trello\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_sequencing_run_glims\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-23T22:53:00.209018Z", "completed_at": "2025-03-23T22:53:00.211389Z"}, {"name": "execute", "started_at": "2025-03-23T22:53:00.211544Z", "completed_at": "2025-03-23T22:53:00.211546Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.005394935607910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.orcavault.sat_library_sequencing_run_plims", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select\n        illumina_id as sequencing_run_id,\n        library_id,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        run,\n        override_cycles,\n        secondary_analysis,\n        number_fastqs,\n        fastq,\n        results,\n        notes,\n        trello\n    from\n        \"orcavault\".\"ods\".\"data_portal_limsrow\"\n\n),\n\ncleaned as (\n\n    select\n        sequencing_run_id,\n        trim(regexp_replace(library_id, E'[\\\\n\\\\r]+', '', 'g')) as library_id,\n        \"timestamp\",\n        run,\n        trim(regexp_replace(override_cycles, E'[\\\\n\\\\r]+', '', 'g')) as override_cycles,\n        trim(regexp_replace(secondary_analysis, E'[\\\\n\\\\r]+', '', 'g')) as secondary_analysis,\n        trim(regexp_replace(number_fastqs, E'[\\\\n\\\\r]+', '', 'g')) as number_fastqs,\n        trim(regexp_replace(fastq, E'[\\\\n\\\\r]+', '', 'g')) as fastq,\n        trim(regexp_replace(results, E'[\\\\n\\\\r]+', '', 'g')) as results,\n        trim(regexp_replace(notes, E'[\\\\n\\\\r]+', '', 'g')) as notes,\n        trim(regexp_replace(trello, E'[\\\\n\\\\r]+', '', 'g')) as trello\n    from\n        source\n\n),\n\ndifferentiated as (\n\n    select\n        *\n    from\n        cleaned\n    \n    where\n        cast(\"timestamp\" as timestamptz) + time '11:00' > ( select coalesce(max(load_datetime), '1900-01-01') as ldts from \"orcavault\".\"dcl\".\"sat_library_sequencing_run_plims\" )\n    \n\n),\n\nencoded as (\n\n    select\n        encode(sha256(cast(sequencing_run_id as bytea)), 'hex') as sequencing_run_hk,\n        encode(sha256(cast(library_id as bytea)), 'hex') as library_hk,\n        encode(sha256(concat(\"timestamp\", run, override_cycles, secondary_analysis, number_fastqs, fastq, results, notes, trello)::bytea), 'hex') as hash_diff,\n        \"timestamp\",\n        run,\n        override_cycles,\n        secondary_analysis,\n        number_fastqs,\n        fastq,\n        results,\n        notes,\n        trello\n    from\n        differentiated\n\n),\n\ntransformed as (\n\n    select\n        encode(sha256(concat(sequencing_run_hk, library_hk)::bytea), 'hex') as library_sequencing_run_hk,\n        cast(\"timestamp\" as timestamptz) + time '11:00' as load_datetime,\n        (select 'data_portal_limsrow') as record_source,\n        hash_diff,\n        \"timestamp\",\n        run,\n        override_cycles,\n        secondary_analysis,\n        number_fastqs,\n        fastq,\n        results,\n        notes,\n        trello\n    from\n        encoded\n\n),\n\nfinal as (\n\n    select\n        cast(library_sequencing_run_hk as char(64)) as library_sequencing_run_hk,\n        cast(load_datetime as timestamptz) as load_datetime,\n        cast(record_source as varchar(255)) as record_source,\n        cast(hash_diff as char(64)) as hash_diff,\n        cast(\"timestamp\" as date) as \"timestamp\",\n        cast(run as integer) as run,\n        cast(override_cycles as varchar(255)) as override_cycles,\n        cast(secondary_analysis as varchar(255)) as secondary_analysis,\n        cast(number_fastqs as varchar(255)) as number_fastqs,\n        cast(fastq as text) as fastq,\n        cast(results as text) as results,\n        cast(notes as text) as notes,\n        cast(trello as text) as trello\n    from\n        transformed\n\n)\n\nselect * from final", "relation_name": "\"orcavault\".\"dcl\".\"sat_library_sequencing_run_plims\"", "batch_results": null}], "elapsed_time": 0.2925412654876709, "args": {"log_path": "/Users/sklin/Projects/umccr/warehouse/orcahouse/orcavault/logs", "populate_cache": true, "send_anonymous_usage_stats": true, "invocation_command": "dbt docs generate", "empty_catalog": false, "log_file_max_bytes": 10485760, "log_format": "default", "macro_debugging": false, "state_modified_compare_vars": false, "which": "generate", "select": [], "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "use_colors_file": true, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "log_format_file": "debug", "static_parser": true, "profiles_dir": "/Users/sklin/Projects/umccr/warehouse/orcahouse/orcavault", "write_json": true, "use_colors": true, "quiet": false, "static": false, "log_level_file": "debug", "favor_state": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_more_unrendered_values": false, "defer": false, "introspect": true, "cache_selected_only": false, "partial_parse_file_diff": true, "exclude": [], "indirect_selection": "eager", "strict_mode": false, "vars": {}, "compile": true, "require_nested_cumulative_type_params": false, "partial_parse": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_level": "info", "source_freshness_run_project_hooks": false, "version_check": true, "skip_nodes_if_on_run_start_fails": false, "require_resource_names_without_spaces": false, "print": true, "project_dir": "/Users/sklin/Projects/umccr/warehouse/orcahouse/orcavault"}}